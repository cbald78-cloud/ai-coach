<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AI Coach</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f9fafb;
    }
    h1 { margin-top: 0; }
    .card {
      background: white;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,.05);
    }
    button {
      width: 100%;
      padding: 14px;
      border-radius: 10px;
      border: none;
      background: #4f46e5;
      color: white;
      font-size: 16px;
      font-weight: 600;
    }
  </style>
</head>
<body>
<header class="top">
  <div>
    <div class="title">AI Coach</div>
    <div class="sub" id="subtitle">Lesson 1: Asking for what you want</div>
  </div>
  <button class="ghost" id="btnReset" type="button">Reset</button>
</header>

<main class="wrap">
  <!-- HOME -->
  <section id="home" class="view">
    <h1 class="h1">Start Lesson 1</h1>
    <p class="muted">
      This lesson teaches the 5 core skills that unlock better AI results. You’ll build prompts as you go.
      Your progress saves automatically on this device.
    </p>

    <div class="card">
      <div class="row space">
        <div>
          <div class="kicker">Everyday AI</div>
          <div class="h2">Ask for things the right way</div>
          <div class="muted">Goal → Context → Constraints → Output → Iterate</div>
        </div>
        <div class="pill" id="homeProgress">0%</div>
      </div>

      <div class="row" style="margin-top:12px">
        <button class="primary" id="btnStart" type="button">Start Lesson</button>
        <button class="ghost" id="btnResume" type="button">Resume</button>
      </div>
    </div>

    <div class="card">
      <div class="h3">Quick note</div>
      <p class="muted">
        This app doesn’t call an AI directly yet. Instead, it helps you build prompts you can paste into ChatGPT (or any AI tool).
        Later we can add an in-app “practice chat.”
      </p>
      <button class="ghost" id="btnOpenChatGPT" type="button">Open ChatGPT</button>
    </div>
  </section>

  <!-- LESSON -->
  <section id="lesson" class="view hidden">
    <div class="row space" style="margin-bottom:10px">
      <button class="link" id="btnBackHome" type="button">← Home</button>
      <div class="pill" id="stepPill">Step 1 of 10</div>
    </div>

    <div class="bar">
      <div class="bar__fill" id="barFill" style="width:0%"></div>
    </div>

    <div class="card">
      <div class="kicker" id="stepKicker"></div>
      <h2 class="h2" id="stepTitle"></h2>
      <p class="muted" id="stepText"></p>

      <!-- interactive area -->
      <div id="interactive" class="interactive"></div>

      <div class="row space" style="margin-top:14px">
        <button class="ghost" id="btnPrev" type="button">Back</button>
        <button class="primary" id="btnNext" type="button">Next</button>
      </div>
    </div>

    <div class="card">
      <div class="row space">
        <div>
          <div class="h3">Your Prompt Builder</div>
          <div class="muted">Everything you enter rolls up into one final prompt.</div>
        </div>
        <button class="ghost" id="btnCopyFinal" type="button">Copy</button>
      </div>
      <textarea id="finalPrompt" class="box" readonly></textarea>

      <div class="row" style="margin-top:10px">
        <button class="primary" id="btnPractice" type="button">Practice: Copy + Open ChatGPT</button>
        <button class="ghost" id="btnClearPrompt" type="button">Clear Prompt</button>
      </div>
    </div>
  </section>

  <div id="toast" class="toast hidden"></div>
</main>

<style>
  :root{
    --bg:#f9fafb; --fg:#111827; --muted:#6b7280;
    --card:#ffffff; --border:#e5e7eb;
    --primary:#4f46e5; --primaryDark:#4338ca;
    --shadow:0 10px 20px rgba(0,0,0,.06);
    --radius:14px; --font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
  }
  body{margin:0;background:var(--bg);color:var(--fg);font-family:var(--font)}
  .top{
    position:sticky;top:0;z-index:20;background:rgba(249,250,251,.92);
    backdrop-filter:blur(8px);border-bottom:1px solid var(--border);
    padding:12px 16px;display:flex;justify-content:space-between;align-items:center
  }
  .title{font-weight:900}
  .sub{color:var(--muted);font-size:13px}
  .wrap{max-width:920px;margin:0 auto;padding:18px 16px 50px}
  .h1{font-size:26px;margin:6px 0 10px}
  .h2{font-size:20px;margin:6px 0 6px}
  .h3{font-weight:800;margin:0 0 8px}
  .muted{color:var(--muted);line-height:1.45}
  .kicker{color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:.05em}
  .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow);margin-bottom:12px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .space{justify-content:space-between}
  .pill{padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#fff;color:var(--muted);font-size:12px}
  button{border:none;border-radius:12px;padding:12px 12px;font:inherit}
  .primary{background:var(--primary);color:#fff;font-weight:900}
  .primary:active{background:var(--primaryDark)}
  .ghost{background:#fff;border:1px solid var(--border);color:var(--fg);font-weight:700}
  .link{background:transparent;color:var(--primary);padding:8px 0;border-radius:0;font-weight:900}
  .view.hidden{display:none}
  .bar{height:10px;border-radius:999px;background:#e5e7eb;overflow:hidden;margin:10px 0 12px}
  .bar__fill{height:100%;background:var(--primary)}
  .interactive{margin-top:14px;padding-top:12px;border-top:1px solid var(--border)}
  .box{width:100%;min-height:140px;border:1px solid var(--border);border-radius:12px;padding:10px 12px;background:#fff;font:14px/1.4 var(--font);resize:vertical}
  .field{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:#fff;font:14px/1.4 var(--font)}
  .choice{display:flex;gap:10px;flex-direction:column}
  .choice button{width:100%}
  .tag{display:inline-block;padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#fff;color:var(--muted);font-size:12px}
  .toast{position:fixed;left:50%;bottom:18px;transform:translateX(-50%);background:#111827;color:#fff;padding:10px 12px;border-radius:12px;box-shadow:var(--shadow);max-width:880px}
  .toast.hidden{display:none}
  .ok{border-color:#bbf7d0}
  .bad{border-color:#fecaca}
</style>

<script>
  // -----------------------------
  // Storage + helpers
  // -----------------------------
  const KEY = "ai_coach_lesson1_v1";

  const $ = (s) => document.querySelector(s);
  const toast = (msg) => {
    const t = $("#toast");
    t.textContent = msg;
    t.classList.remove("hidden");
    setTimeout(() => t.classList.add("hidden"), 1500);
  };

  function loadState(){
    try { return JSON.parse(localStorage.getItem(KEY) || "{}"); }
    catch { return {}; }
  }
  function saveState(obj){
    localStorage.setItem(KEY, JSON.stringify(obj));
  }

  // Our prompt builder model (what the learner fills in)
  const modelDefaults = {
    currentStep: 0,
    builder: {
      goal: "",
      context: "",
      constraints: [],
      output: "",
      tone: "",
      askFor: "",
      followupRule: "",
      exampleFilled: ""
    }
  };

  function getModel(){
    const s = loadState();
    return {
      ...modelDefaults,
      ...s,
      builder: { ...modelDefaults.builder, ...(s.builder || {}) }
    };
  }

  function setModel(patch){
    const m = getModel();
    const next = { ...m, ...patch, builder: { ...m.builder, ...(patch.builder || {}) } };
    saveState(next);
    return next;
  }

  function percentComplete(){
    const m = getModel();
    const total = lessonSteps.length;
    const idx = Math.min(m.currentStep, total-1);
    return Math.round(((idx) / (total-1)) * 100);
  }

  function buildFinalPrompt(){
    const b = getModel().builder;

    const constraints = (b.constraints || []).length
      ? `Constraints:\n- ${b.constraints.join("\n- ")}\n\n`
      : "";

    const tone = b.tone ? `Tone: ${b.tone}\n\n` : "";
    const output = b.output ? `Output format: ${b.output}\n\n` : "";
    const askFor = b.askFor ? `What I want from you:\n${b.askFor}\n\n` : "";
    const follow = b.followupRule ? `If anything is unclear, ${b.followupRule}\n\n` : "";

    const goal = b.goal ? `Goal:\n${b.goal}\n\n` : "";
    const context = b.context ? `Context:\n${b.context}\n\n` : "";

    return `${goal}${context}${constraints}${tone}${output}${askFor}${follow}`.trim();
  }

  async function copy(text){
    try{
      await navigator.clipboard.writeText(text);
      toast("Copied.");
      return true;
    } catch {
      toast("Copy failed. Try again.");
      return false;
    }
  }

  function openChatGPT(){
    // Keep it simple—opens in a new tab
    window.open("https://chat.openai.com/", "_blank");
  }

  // -----------------------------
  // Lesson content (immersive)
  // Total steps: 10 (5 skills + practice + quiz)
  // -----------------------------
  const lessonSteps = [
    {
      kicker: "Skill 1 of 5",
      title: "Define a clear goal (the outcome)",
      text: "AI cannot read your mind. A clear goal is one sentence that describes the outcome you want. You can add details later.",
      render: () => renderGoalStep()
    },
    {
      kicker: "Practice",
      title: "Spot the difference: vague vs clear",
      text: "Pick the clearer request. This trains your instincts.",
      render: () => renderVagueVsClear()
    },
    {
      kicker: "Skill 2 of 5",
      title: "Add context (only what matters)",
      text: "Context helps the AI make correct assumptions. Keep it relevant: who, what you have, what you tried, what “good” looks like.",
      render: () => renderContextStep()
    },
    {
      kicker: "Skill 3 of 5",
      title: "Add constraints (boundaries)",
      text: "Constraints reduce bad guesses. Examples: time, budget, tools, audience, reading level, what to avoid, and must-include items.",
      render: () => renderConstraintsStep()
    },
    {
      kicker: "Practice",
      title: "Choose constraints that actually help",
      text: "Pick 3 constraints that would most improve your result.",
      render: () => renderConstraintsQuiz()
    },
    {
      kicker: "Skill 4 of 5",
      title: "Specify the output format",
      text: "Tell the AI what the answer should look like: checklist, table, step-by-step, bullets, script, shopping list, etc.",
      render: () => renderOutputStep()
    },
    {
      kicker: "Skill 5 of 5",
      title: "Tell it how to behave (tone + process)",
      text: "You can set tone (simple, friendly, direct) and process (ask questions first, then deliver). This is huge for ADHD-friendly responses.",
      render: () => renderToneProcessStep()
    },
    {
      kicker: "Build it",
      title: "Assemble your final request",
      text: "Now you’ll choose what you want the AI to do, and set a rule for follow-ups. This makes the response higher quality.",
      render: () => renderAskForStep()
    },
    {
      kicker: "Practice run",
      title: "Try it in ChatGPT",
      text: "Copy your final prompt and test it. Then come back and refine it (iteration is the secret).",
      render: () => renderPracticeStep()
    },
    {
      kicker: "Checkpoint",
      title: "Mini-quiz: Did we hit the 5 essentials?",
      text: "Answer 5 quick checks. This locks the skills in memory.",
      render: () => renderFinalQuiz()
    }
  ];

  // -----------------------------
  // UI Rendering
  // -----------------------------
  function showHome(){
    $("#home").classList.remove("hidden");
    $("#lesson").classList.add("hidden");
    $("#homeProgress").textContent = `${percentComplete()}%`;
  }

  function showLesson(){
    $("#home").classList.add("hidden");
    $("#lesson").classList.remove("hidden");
    renderStep();
  }

  function renderStep(){
    const m = getModel();
    const idx = m.currentStep || 0;
    const step = lessonSteps[idx];

    $("#stepPill").textContent = `Step ${idx+1} of ${lessonSteps.length}`;
    $("#barFill").style.width = `${Math.round((idx/(lessonSteps.length-1))*100)}%`;

    $("#stepKicker").textContent = step.kicker;
    $("#stepTitle").textContent = step.title;
    $("#stepText").textContent = step.text;

    // interactive area
    const host = $("#interactive");
    host.innerHTML = "";
    step.render();

    // nav
    $("#btnPrev").disabled = idx === 0;
    $("#btnNext").textContent = idx === lessonSteps.length-1 ? "Finish" : "Next";

    // update builder textarea
    $("#finalPrompt").value = buildFinalPrompt() || "Start filling steps above to build your final prompt…";
    $("#homeProgress").textContent = `${percentComplete()}%`;
  }

  function go(delta){
    const m = getModel();
    const next = m.currentStep + delta;

    if (next < 0) return;

    if (next >= lessonSteps.length){
      toast("Lesson complete. Great work.");
      showHome();
      return;
    }

    setModel({ currentStep: next });
    renderStep();
  }

  // -----------------------------
  // Interactive step builders
  // -----------------------------
  function renderGoalStep(){
    const host = $("#interactive");
    host.innerHTML = `
      <div class="h3">Write your goal</div>
      <p class="muted">One sentence. Example: “Help me write a grocery list for taco night for 4 people under $30.”</p>
      <textarea id="goalInput" class="box" placeholder="My goal is: ..."></textarea>
      <div class="row space" style="margin-top:10px">
        <span class="tag" id="goalHint">Tip: outcomes > questions</span>
        <button class="ghost" id="goalExample" type="button">Use an example</button>
      </div>
    `;

    const m = getModel();
    const el = $("#goalInput");
    el.value = m.builder.goal || "";
    el.addEventListener("input", () => {
      setModel({ builder: { goal: el.value.trim() } });
      $("#finalPrompt").value = buildFinalPrompt() || "";
    });

    $("#goalExample").onclick = () => {
      el.value = "Help me create a click-through lesson that teaches beginners how to ask AI for help, with examples and practice prompts.";
      el.dispatchEvent(new Event("input"));
      toast("Example inserted.");
    };
  }

  function renderVagueVsClear(){
    const host = $("#interactive");
    host.innerHTML = `
      <div class="h3">Pick the clearer request</div>
      <div class="choice">
        <button class="ghost" id="c1" type="button">“Help me with AI.”</button>
        <button class="ghost" id="c2" type="button">“I want a 7-step plan to use AI to plan dinners for a family of 4. Keep it simple, include a shopping list, and avoid fancy ingredients.”</button>
      </div>
      <p class="muted" id="feedback" style="margin-top:10px"></p>
    `;
    $("#c1").onclick = () => $("#feedback").textContent = "That’s vague. The AI has to guess what ‘help’ means, so you get generic answers.";
    $("#c2").onclick = () => $("#feedback").textContent = "Correct. Clear goal + constraints + output request = better responses.";
  }

  function renderContextStep(){
    const host = $("#interactive");
    host.innerHTML = `
      <div class="h3">Add only relevant context</div>
      <p class="muted">Keep it to 2–6 lines. Include what you have, what you tried, and what “good” means.</p>
      <textarea id="contextInput" class="box" placeholder="Context: ..."></textarea>
      <div class="row" style="margin-top:10px">
        <button class="ghost" id="contextTemplate" type="button">Insert a template</button>
      </div>
    `;

    const m = getModel();
    const el = $("#contextInput");
    el.value = m.builder.context || "";
    el.addEventListener("input", () => {
      setModel({ builder: { context: el.value.trim() } });
      $("#finalPrompt").value = buildFinalPrompt() || "";
    });

    $("#contextTemplate").onclick = () => {
      el.value =
`I’m a beginner.
I learn best by doing (short steps).
I want a direct, practical answer.
If you need more info, ask me 2–3 questions first.`;
      el.dispatchEvent(new Event("input"));
      toast("Template inserted.");
    };
  }

  function renderConstraintsStep(){
    const host = $("#interactive");
    const options = [
      "Keep it under 10 minutes to read",
      "Use simple language (no jargon)",
      "Give step-by-step instructions",
      "Include 3 examples",
      "Ask me up to 3 questions first",
      "Avoid extra fluff",
      "Format as a checklist",
      "Assume I’m using an iPhone"
    ];

    const m = getModel();
    const selected = new Set(m.builder.constraints || []);

    host.innerHTML = `
      <div class="h3">Choose constraints (tap to toggle)</div>
      <p class="muted">Pick what matters. Too many constraints can make answers rigid.</p>
      <div class="choice" id="constraintButtons"></div>
      <div class="row space" style="margin-top:10px">
        <span class="tag" id="constraintCount">${selected.size} selected</span>
        <button class="ghost" id="constraintClear" type="button">Clear</button>
      </div>
    `;

    const box = $("#constraintButtons");
    options.forEach(opt => {
      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "ghost";
      btn.textContent = opt;

      const applyStyle = () => {
        btn.classList.toggle("primary", selected.has(opt));
        btn.classList.toggle("ghost", !selected.has(opt));
      };
      applyStyle();

      btn.onclick = () => {
        if (selected.has(opt)) selected.delete(opt);
        else selected.add(opt);

        setModel({ builder: { constraints: Array.from(selected) } });
        $("#finalPrompt").value = buildFinalPrompt() || "";
        $("#constraintCount").textContent = `${selected.size} selected`;
        applyStyle();
      };

      box.appendChild(btn);
    });

    $("#constraintClear").onclick = () => {
      selected.clear();
      setModel({ builder: { constraints: [] } });
      renderStep();
      toast("Cleared.");
    };
  }

  function renderConstraintsQuiz(){
    const host = $("#interactive");
    host.innerHTML = `
      <div class="h3">Pick the best 3 constraints for THIS goal</div>
      <p class="muted"><strong>Scenario:</strong> “Write me a 30-minute dinner plan for 4 people using Walmart ingredients.”</p>
      <div class="choice">
        <button class="ghost" data-a="0" type="button">Tell me the history of Walmart</button>
        <button class="ghost" data-a="1" type="button">Give a shopping list and a timed cooking plan</button>
        <button class="ghost" data-a="1" type="button">Keep it under $25 and avoid spicy food</button>
        <button class="ghost" data-a="1" type="button">Use simple language and give substitutions</button>
      </div>
      <p class="muted" id="cq" style="margin-top:10px"></p>
    `;
    host.querySelectorAll("button[data-a]").forEach(btn => {
      btn.onclick = () => {
        const ok = btn.getAttribute("data-a") === "1";
        $("#cq").textContent = ok
          ? "Good constraint. This will meaningfully improve the answer."
          : "Not relevant. Constraints must directly shape the output you want.";
      };
    });
  }

  function renderOutputStep(){
    const host = $("#interactive");
    const choices = [
      "Checklist (bullets)",
      "Step-by-step plan",
      "Table (columns)",
      "Script I can read",
      "Shopping list + plan",
      "Two versions: short + detailed"
    ];

    host.innerHTML = `
      <div class="h3">Choose an output format</div>
      <p class="muted">This controls how the answer is structured. Pick one.</p>
      <div class="choice" id="outChoices"></div>
      <input id="outCustom" class="field" placeholder="Or type a custom format..." style="margin-top:10px" />
    `;

    const m = getModel();
    const outBox = $("#outChoices");

    choices.forEach(c => {
      const b = document.createElement("button");
      b.type="button";
      b.className = "ghost";
      b.textContent = c;
      b.onclick = () => {
        setModel({ builder: { output: c } });
        $("#finalPrompt").value = buildFinalPrompt() || "";
        toast("Output format set.");
        renderStep();
      };
      outBox.appendChild(b);
    });

    const custom = $("#outCustom");
    custom.value = m.builder.output || "";
    custom.addEventListener("input", () => {
      setModel({ builder: { output: custom.value.trim() } });
      $("#finalPrompt").value = buildFinalPrompt() || "";
    });
  }

  function renderToneProcessStep(){
    const host = $("#interactive");
    host.innerHTML = `
      <div class="h3">Set tone + process</div>
      <p class="muted">This is how you keep responses ADHD-friendly: direct, short steps, and “ask first if unclear.”</p>

      <div class="row" style="margin-top:8px">
        <span class="tag">Tone</span>
      </div>
      <div class="choice" id="toneChoices"></div>

      <div class="row" style="margin-top:12px">
        <span class="tag">Process</span>
      </div>
      <div class="choice" id="procChoices"></div>
    `;

    const tones = ["Direct and simple", "Friendly coach", "Professional and concise", "Detailed and thorough"];
    const procs = [
      "Ask me up to 3 questions first, then answer",
      "Answer immediately, then ask follow-ups",
      "Give 3 options, then recommend 1",
      "Check assumptions before final answer"
    ];

    const toneHost = $("#toneChoices");
    tones.forEach(t => {
      const b = document.createElement("button");
      b.type="button"; b.className="ghost"; b.textContent=t;
      b.onclick = () => {
        setModel({ builder: { tone: t } });
        $("#finalPrompt").value = buildFinalPrompt() || "";
        toast("Tone set.");
        renderStep();
      };
      toneHost.appendChild(b);
    });

    const procHost = $("#procChoices");
    procs.forEach(p => {
      const b = document.createElement("button");
      b.type="button"; b.className="ghost"; b.textContent=p;
      b.onclick = () => {
        setModel({ builder: { followupRule: p.endsWith(".") ? p : (p + ".") } });
        $("#finalPrompt").value = buildFinalPrompt() || "";
        toast("Process set.");
        renderStep();
      };
      procHost.appendChild(b);
    });
  }

  function renderAskForStep(){
    const host = $("#interactive");
    host.innerHTML = `
      <div class="h3">What do you want the AI to produce?</div>
      <p class="muted">Be explicit about deliverables. This is where good prompts become great prompts.</p>

      <textarea id="askForInput" class="box" placeholder="Example: Give me 3 options, each with pros/cons, then recommend the best one and why."></textarea>

      <div class="row" style="margin-top:10px">
        <button class="ghost" id="askForExample" type="button">Insert a strong example</button>
      </div>
    `;

    const m = getModel();
    const el = $("#askForInput");
    el.value = m.builder.askFor || "";
    el.addEventListener("input", () => {
      setModel({ builder: { askFor: el.value.trim() } });
      $("#finalPrompt").value = buildFinalPrompt() || "";
    });

    $("#askForExample").onclick = () => {
      el.value =
`1) Ask me up to 3 clarifying questions if needed.
2) Give me 3 options.
3) For each option: pros/cons, time, cost, and risks.
4) Recommend the best option for me and explain why.
5) End with a short checklist I can follow.`;
      el.dispatchEvent(new Event("input"));
      toast("Example inserted.");
    };
  }

  function renderPracticeStep(){
    const host = $("#interactive");
    host.innerHTML = `
      <div class="h3">Practice loop (this is where mastery happens)</div>
      <p class="muted">
        1) Copy your final prompt.<br/>
        2) Open ChatGPT and paste it.<br/>
        3) Come back and refine one thing: goal, constraints, or format.
      </p>
      <div class="row">
        <button class="primary" id="copyAndOpen" type="button">Copy + Open ChatGPT</button>
        <button class="ghost" id="editReminder" type="button">What should I refine?</button>
      </div>
      <p class="muted" id="refHint" style="margin-top:10px"></p>
    `;

    $("#copyAndOpen").onclick = async () => {
      const text = buildFinalPrompt();
      if (!text) return toast("Build your prompt first.");
      const ok = await copy(text);
      if (ok) openChatGPT();
    };

    $("#editReminder").onclick = () => {
      const tips = [
        "Refine the goal: make it one sentence and outcome-based.",
        "Add one constraint that truly matters (time, budget, format).",
        "Specify the output format more clearly (checklist, table, steps).",
        "Tell it what to avoid (jargon, long explanations, etc.).",
        "Ask for options + a recommendation, not just a single answer."
      ];
      $("#refHint").textContent = tips[Math.floor(Math.random() * tips.length)];
    };
  }

  function renderFinalQuiz(){
    const host = $("#interactive");
    host.innerHTML = `
      <div class="h3">5 essentials check</div>
      <p class="muted">Answer these. If you miss one, adjust your prompt builder above.</p>

      <div class="card" style="box-shadow:none;margin:12px 0 0">
        <div class="muted"><strong>1)</strong> Does your prompt state a specific goal?</div>
        <div class="row" style="margin-top:8px">
          <button class="ghost" data-q="1" data-a="yes" type="button">Yes</button>
          <button class="ghost" data-q="1" data-a="no" type="button">No</button>
        </div>
      </div>

      <div class="card" style="box-shadow:none;margin:12px 0 0">
        <div class="muted"><strong>2)</strong> Did you include relevant context (not a long story)?</div>
        <div class="row" style="margin-top:8px">
          <button class="ghost" data-q="2" data-a="yes" type="button">Yes</button>
          <button class="ghost" data-q="2" data-a="no" type="button">No</button>
        </div>
      </div>

      <div class="card" style="box-shadow:none;margin:12px 0 0">
        <div class="muted"><strong>3)</strong> Did you add constraints that shape the answer?</div>
        <div class="row" style="margin-top:8px">
          <button class="ghost" data-q="3" data-a="yes" type="button">Yes</button>
          <button class="ghost" data-q="3" data-a="no" type="button">No</button>
        </div>
      </div>

      <div class="card" style="box-shadow:none;margin:12px 0 0">
        <div class="muted"><strong>4)</strong> Did you specify the output format?</div>
        <div class="row" style="margin-top:8px">
          <button class="ghost" data-q="4" data-a="yes" type="button">Yes</button>
          <button class="ghost" data-q="4" data-a="no" type="button">No</button>
        </div>
      </div>

      <div class="card" style="box-shadow:none;margin:12px 0 0">
        <div class="muted"><strong>5)</strong> Did you tell the AI how to proceed (questions first / options / recommendation)?</div>
        <div class="row" style="margin-top:8px">
          <button class="ghost" data-q="5" data-a="yes" type="button">Yes</button>
          <button class="ghost" data-q="5" data-a="no" type="button">No</button>
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <button class="primary" id="scoreQuiz" type="button">Score my quiz</button>
        <span class="tag" id="quizScore">Not scored yet</span>
      </div>
    `;

    const answers = {};
    host.querySelectorAll("button[data-q]").forEach(btn => {
      btn.onclick = () => {
        const q = btn.getAttribute("data-q");
        const a = btn.getAttribute("data-a");
        answers[q] = a;
        toast(`Saved: Q${q} = ${a.toUpperCase()}`);
      };
    });

    $("#scoreQuiz").onclick = () => {
      let score = 0;
      for (let i=1;i<=5;i++){
        if (answers[String(i)] === "yes") score++;
      }
      $("#quizScore").textContent = `${score}/5`;
      if (score === 5) toast("Perfect. You’ve got the framework.");
      else toast("Good. Go refine the missing pieces above.");
    };
  }

  // -----------------------------
  // Wire up buttons
  // -----------------------------
  $("#btnStart").addEventListener("click", () => {
    setModel({ currentStep: 0 });
    showLesson();
  });

  $("#btnResume").addEventListener("click", () => {
    const m = getModel();
    if ((m.currentStep || 0) === 0 && !buildFinalPrompt()) {
      toast("Nothing to resume yet. Starting fresh.");
      setModel({ currentStep: 0 });
    }
    showLesson();
  });

  $("#btnBackHome").addEventListener("click", showHome);
  $("#btnPrev").addEventListener("click", () => go(-1));
  $("#btnNext").addEventListener("click", () => go(+1));

  $("#btnReset").addEventListener("click", () => {
    localStorage.removeItem(KEY);
    $("#finalPrompt").value = "";
    toast("Reset complete.");
    showHome();
  });

  $("#btnCopyFinal").addEventListener("click", async () => {
    const text = buildFinalPrompt();
    if (!text) return toast("Build your prompt first.");
    await copy(text);
  });

  $("#btnPractice").addEventListener("click", async () => {
    const text = buildFinalPrompt();
    if (!text) return toast("Build your prompt first.");
    const ok = await copy(text);
    if (ok) openChatGPT();
  });

  $("#btnClearPrompt").addEventListener("click", () => {
    setModel({ builder: { goal:"", context:"", constraints:[], output:"", tone:"", askFor:"", followupRule:"" } });
    $("#finalPrompt").value = "Start filling steps above to build your final prompt…";
    toast("Prompt cleared.");
    renderStep();
  });

  $("#btnOpenChatGPT").addEventListener("click", openChatGPT);

  // Init
  showHome();
</script>
</body>
</html>
